<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>excel-clone</title>
  <style>
    *,*::after,*::before {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body { font-family: "Calibri", Candara, "Segoe UI", Optima, sans-serif; }

    table {
      border-collapse: collapse;
      margin-top: 10px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 5px;
      text-align: center;
      font-size: 12px;
      position: relative;
      min-width: 60px;
      height: 25px;
    }

    thead,
    tr td:first-child {
      background: #eee;
      font-weight: bold;
    }

    span,
    input {
      position: absolute;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    input {
      border: none;
      outline: none;
      text-align: center;
      display: none;
    }
    /* Buttons */
    .toolbar {
      display: flex;
      gap: 4px;
      margin-bottom: 10px;
    }

    .toolbar button {
      background-color: #ebebeb;
      border: none;
      padding: 4px 10px;
      /* font-size: 12px; */
      /* font-weight: 500; */
      cursor: pointer;
      transition: all 0.1s;
    }

    .toolbar button:hover {
      background-color: #cecece;
      border-color: #666;
    }
  </style>
</head>

<body>
  <img src="https://upload.wikimedia.org/wikipedia/commons/7/73/Microsoft_Excel_2013-2019_logo.svg" alt="Logo Excel"
    width="40">
  <!-- Algunos Botones  -->
  <div class="toolbar">
    <button>Archivo</button>
    <button>Editar</button>
    <button>Ver</button>
    <button>Insertar</button>
    <button>Formato</button>
    <button>Ayuda</button>
  </div>

  <table>
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    const ROWS = 10
    const COLUMNS = 5
    const FIRST_CHAR_CODE = 65

    const range = n => Array.from({ length: n }, (_, i) => i)
    const getColumn = i => String.fromCharCode(FIRST_CHAR_CODE + i)

    let STATE = range(COLUMNS).map(col =>
      range(ROWS).map(row => ({
        value: "",
        computedValue: `${getColumn(col)}${row + 1}`
      }))
    )

    const $thead = document.querySelector("thead")
    const $tbody = document.querySelector("tbody")

    const render = () => {
      $thead.innerHTML = `
        <tr>
          <th></th>
          ${range(COLUMNS).map(i => `<th>${getColumn(i)}</th>`).join("")}
        </tr>
      `
      $tbody.innerHTML = range(ROWS).map(row => `
        <tr>
          <td>${row + 1}</td>
          ${range(COLUMNS).map(col => `
            <td data-x="${col}" data-y="${row}">
              <span>${STATE[col][row].value || ""}</span>
              <input type="text" value="${STATE[col][row].value}">
            </td>
          `).join("")}
        </tr>
      `).join("")
    }

    $tbody.addEventListener("click", e => {
      const td = e.target.closest("td[data-x]")
      if (!td) return
      const { x, y } = td.dataset
      const input = td.querySelector("input")
      const span = td.querySelector("span")

      span.style.display = "none"
      input.style.display = "flex"
      input.focus()
      input.setSelectionRange(input.value.length, input.value.length)

      input.addEventListener("blur", e => {
        STATE[x][y].value = e.target.value
        span.textContent = e.target.value
        span.style.display = "flex"
        input.style.display = "none"
      }, { once: true })
    })

    render()
  </script>
</body>

</html>